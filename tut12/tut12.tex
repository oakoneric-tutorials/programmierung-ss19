\documentclass[aspectratio=1610,onlymath, ngerman, handout]{beamer}
% \documentclass[aspectratio=1610,onlymath,handout]{beamer}
\input{../beamer_settings}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\defineTitle{12}{\textsc{Hoare}-Kalkül}{05.~Juli~2019}

\usepackage[inline]{enumitem}

\renewcommand{\emph}[1]{\textbf{#1}}
\newcommand{\coloremph}[1]{\textcolor{cdpurple}{#1}}
\newcommand{\col}[1]{\textcolor{cdpurple}{\boldsymbol{#1}}}
\newcommand{\coll}[1]{\textcolor{cddarkgreen}{\boldsymbol{#1}}}
\newcommand{\colll}[1]{\textcolor{cdorange}{\boldsymbol{#1}}}

\DeclareMathSymbol{*}{\mathbin}{symbols}{"01}

\renewcommand*{\headerinfo}{\color{cdgray}\textbf{Github:} \url{https://github.com/oakoneric/programmierung-ss19}}
\arraycolsep2pt

\usepackage{aligned-overset}
\usepackage{array}
\chardef\_=`_

\renewcommand{\epsilon}{\varepsilon}
\newcommand{\labelitemi}{$\blacktriangleright$}
\newcommand{\labelitemii}{$\vartriangleright$}
\usepackage{tabu}
\usepackage{booktabs}
\newcommand*\head{\rowfont{\bfseries}}
\newcommand*{\tw}{\rowfont{\ttfamily}}
\newcommand{\logand}{ \ \land \ }

\begin{document}
    \maketitle
 
% 	{
% 	\setbeamercolor{background canvas}{bg=cdgray}
% 	\color{white}
% 	\begin{frame}
% 		\centering \Huge \emph{Von letzter Woche $\dots$}
% 	\end{frame}
% 	}
% 
%	 \begin{frame} \frametitle{Aufgabe 3}
%	 \small
%	 Gegeben ist folgender $AM_1$-Code: \\
%	 \bigskip 
%	 
%	 \begin{minipage}{\dimexpr0.33\linewidth-\fboxrule-\fboxsep}
%	 	\begin{ttfamily}
%	 		\begin{enumerate}[label=\arabic*:, nolistsep]
%	 			\item INIT 1;
%	 			\item CALL 1§;
%	 			\item INIT 0;
%	 			\item LOADI(-2);
%	 			\item LIT 2;
%	 			\item GT;
%	 			\item JMC 12;
%	 		\end{enumerate}
%	 	\end{ttfamily}
%	 \end{minipage}
%	 \begin{minipage}{\dimexpr0.33\linewidth-\fboxrule-\fboxsep}
%	 	\begin{ttfamily}
%	 		\begin{enumerate}[label=\arabic*:, nolistsep]
%	 			\setcounter{enumi}{7}
%	 			\item LOADI(-2);
%	 			\item LIT 2;
%	 			\item DIV;
%	 			\item STOREI(-2);
%	 			\item RET 1;
%	 			\item INIT 0;
%	 			\item READ(global, 1);
%	 		\end{enumerate}
%	 	\end{ttfamily}
%	 \end{minipage}
%	 \begin{minipage}{\dimexpr0.33\linewidth-\fboxrule-\fboxsep}
%	 	\begin{ttfamily}
%	 		\begin{enumerate}[label=\arabic*:, nolistsep]
%	 			\setcounter{enumi}{14}
%	 			\item LOADA(global ,1);
%	 			\item PUSH;
%	 			\item CALL 3;
%	 			\item WRITE(global ,1);
%	 			\item JMP 0;
%	 			
%	 		\end{enumerate}
%	 	\end{ttfamily}
%	 \end{minipage}
%	 
%	 \bigskip
%	 
%	 Gesucht ist das Ablaufprotokoll der $AM_1$ mit der Anfangskonfiguration $\sigma = (14, \epsilon, 0:0:1, 3, 4, \epsilon)$.
%	\end{frame}
%	
%	\begin{frame} \frametitle{Aufgabe 3}
%	\footnotesize
%	\vspace{-6pt}
%	\begin{center}
%	\begin{tabu}{rrcrclcccrcrl}
%		\head & BZ && DK && LZK && REF && Inp && Out & \\ \hline
%		( & 14 &,& $\epsilon$ &,& 0:0:1 &,& 3 &,& 4 &,& $\epsilon$ & ) \\
%		( & 15 &,& $\epsilon$ &,& 4:0:1 &,& 3 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 16 &,& 1 &,& 4:0:1 &,& 3 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 17 &,& $\epsilon$ &,& 4:0:1:1 &,& 3 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 3 &,& $\epsilon$ &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 4 &,& $\epsilon$ &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 5 &,& 4 &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 6 &,& 2:4 &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 7 &,& 1 &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 8 &,& $\epsilon$ &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 9 &,& 4 &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 10 &,& 2:4 &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 11 &,& 2 &,& 4:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 12 &,& $\epsilon$ &,& 2:0:1:1:18:3 &,& 6 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 18 &,& $\epsilon$ &,& 2:0:1 &,& 3 &,& $\epsilon$ &,& $\epsilon$ & ) \\
%		( & 19 &,& $\epsilon$ &,& 2:0:1 &,& 3 &,& $\epsilon$ &,& 2 & ) \\
%	\end{tabu}
%	\end{center}
%	\end{frame}   
%    
%    {
%    	\setbeamercolor{background canvas}{bg=cdgray}
%    	\color{white}
%    	\begin{frame}
%    	\centering \Huge \emph{Übungsblatt 12 $\dots$}
%    \end{frame}
%	}
    
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%$$$$$$$$$$
    

    \begin{frame} \frametitle{\textsc{Hoare}-Kalkül}
    \small
    	\begin{itemize}
    		\item Beweis / Verifikation von Programmeigenschaften \pause 
    		\item Verifikationsformeln der Form $\{P\} \mathbf{A} \{Q\}$
    		\begin{itemize}
    			\item $P$ und $Q$ sind Zusicherungen (prädikatenlogische Ausdrücke)
    			\item $P$ heißt \emph{Vorbedingung}, $Q$ heißt \emph{Nachbedingung}
    			\item Beschreibung der Veränderung von Zusicherungen \pause
    			\item \emph{Bedeutung}: Wenn die Variablenwerte vor Ausführung von $\mathbf{A}$ die Zusicherung $P$ erfüllen und $\mathbf{A}$ terminiert, dann erfüllen die Variablen nach Ausführung von $\mathbf{A}$ die Zusicherung $Q$
    		\end{itemize} \pause
    	\item Aufstellen eines Beweisbaumes mit zur Verfügung stehenden Regeln
    	\end{itemize}
    \end{frame}
    
    
    \begin{frame} \frametitle{\textsc{Hoare}-Kalkül -- Regeln}
    \small
    	\begin{itemize}
    		\item Zuweisungsaxiom
    		\item Sequenzregel
    		\item CompRegel
    		\item Iterationsregel
    		\item (erste und zweite) Alternativregel
    		\item Konsequenzregeln
    		\begin{itemize}
    			\item stärkere Vorbedingung
    			\item schwächere Nachbedingung
    		\end{itemize}
    	\end{itemize}
    \end{frame}

	\begin{frame} \frametitle{Schleifeninvariante}
	\small
		Für die Iterationsregel benötigen wir die Schleifeninvariante $SI$.
		In den meisten unserer Fälle ist diese von der Form $SI = A \land B$, wobei
		\begin{itemize}
			\item $A$ den Zusammenhang zwischen Zählvariable und Akkumulationsvariablen beschreibt. Führe dazu einige Iterationen der Schleife durch und leite daraus einen Zusammenhang her.
			\item $B$ die abgeschwächte Schleifenbedingung ist. Dabei nehmen wir die letztmögliche Variablenbelegung, für die die Schleifenbedingung $\pi$ noch wahr ist und führen den Schleifenrumpf noch einmal darauf aus ($\to \pi'$). \\
			$\Rightarrow B = \pi \cup \pi'$. 
		\end{itemize}
	\end{frame}

	\begin{frame} \frametitle{Aufgabe 1}
	\small
		\begin{doodle}{cddarkblue}
			\emph{Verfikationsformel:} \footnotesize
			\begin{equation*}
			\{ (x \ge 0) \land (x = x1) \land (z=0) \land (y \ge 0) \} \ \ \texttt{\emph{while} (x1 > 0) \{x1 = x1-1; z = z+y;\}} \ \ \{(z = y * x)\}
			\end{equation*}
		\end{doodle}
		
		\bigskip \pause
		
		\begin{minipage}{\dimexpr0.4\linewidth-\fboxrule-\fboxsep}
			\emph{Schleifeninvariante:} \pause
			\begin{center}
				\begin{tabu}{ccc}
					\toprule
					\head $\#$ & \texttt{x1} & \texttt{z} \\
					\midrule \midrule
					$0$	 & $x$   & $0$  \\
					$1$  & $x-1$ & $y$  \\
					$2$  & $x-2$ & $2y$ \\
					$N$  & $x-N$ & $Ny$ \\
					\bottomrule
				\end{tabu}
				
				\smallskip
				
				$\left| \begin{array}{rl}
				\texttt{x1} &\texttt{= x - N} \\ \texttt{z} &\texttt{= N * y}
				\end{array} \right|$ \\[6pt]
				$\Rightarrow \enskip A = (\texttt{z = (x-x1) * y})$
			\end{center}
		\end{minipage}
		\begin{minipage}{\dimexpr0.6\linewidth-\fboxrule-\fboxsep}
			abgeschwächte Schleifenbedingung:
			\begin{itemize}
				\item Schleifenbedingung $\pi = (\texttt{x1 > 0})$
				\item Schleifenbedingung letztmalig wahr für \texttt{x1 = 1}
				\item Wert nach nochmaligem Schleifendurchlauf: $\pi' = (\texttt{x1 = 0})$
				\item $B = \pi \cup \pi' = (\texttt{x1} \ge \texttt{0})$
			\end{itemize}
		\medskip
		
		\fbox{$\Longrightarrow SI = A \land B = (\texttt{z=(x-x1)*y}) \land (\texttt{x1} \ge \texttt{0})$}
		
		\end{minipage}
	\end{frame}

	\begin{frame} \frametitle{Aufgabe 1}
	\small
	
		\begin{doodle}{cddarkblue}
			\emph{Verfikationsformel:} \footnotesize
			\begin{equation*}
			\{ (x \ge 0) \land (x = x1) \land (z=0) \land (y \ge 0) \} \ \ \texttt{\emph{while} (x1 > 0) \{x1 = x1-1; z = z+y;\}} \ \ \{(z = y*x)\}
			\end{equation*}
		\end{doodle}
		
		\bigskip \pause
		
		Sei $SI = A \land B = (\texttt{z=(x-x1)*y}) \land (\texttt{x1} \ge \texttt{0})$ und $\pi = \texttt{x1 > 0}$.
		
		
			\begin{align*}
			A &= C = D = G = SI \\
			B &= SI \logand \lnot \pi = (\texttt{z=(x-x1)*y}) \logand (\texttt{x1} \ge \texttt{0}) \logand \lnot (\texttt{x1 > 0}) \\
			E &= SI \logand \pi = (\texttt{z=(x-x1)*y}) \logand (\texttt{x1} \ge \texttt{0}) \logand (\texttt{x1 > 0} )
			\end{align*}
	\end{frame}

	\begin{frame} \frametitle{Aufgabe 2}
%	\small
		\pause
		\begin{minipage}{\dimexpr0.5\linewidth-\fboxrule-\fboxsep}
			\begin{align*}
				A &= \text{true} \logand (y < 0) \\
				B &= \text{true} \logand \lnot(y < 0) \\
				C &= A \\
				D &= A \\
				E &= -(3*y) + 1 \ge 0 \\
				F &= E 
				\end{align*}
		\end{minipage}
		\begin{minipage}{\dimexpr0.5\linewidth-\fboxrule-\fboxsep}
			\begin{align*}
				G &= E \\
				H &= -x + 1 \ge 0 \\
				J &= H \\
				K &= (y \ge 0) \\
				L &= \text{stärkere Vorbedingung} \\
				M &= \text{Sequenzregel} 
			\end{align*}
		\end{minipage}
	
		\bigskip
		\pause
		
		\begin{doodle}{cddarkblue}
			\emph{zu zeigen:} $\text{true} \ \land \ (y < 0) \enskip \Rightarrow \enskip (-3 * y + 1 \ge 0)$
%			\pause
			\begin{alignat*}{2}
			\text{true} \ \land \ (y < 0) \enskip &\Rightarrow \quad &y &< 0 \\
			&\Rightarrow \quad &-3 * y &> 0 \\ 
			&\Rightarrow \quad &-3 * y + 1 &> 1 \\ 
			&\Rightarrow \quad &-3 * y + 1 &\ge 0 
			\end{alignat*}
		\end{doodle}
		
	\end{frame}
    
    
\end{document}